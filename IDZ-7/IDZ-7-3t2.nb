(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13473,        347]
NotebookOptionsPosition[     13224,        334]
NotebookOutlinePosition[     13572,        349]
CellTagsIndexPosition[     13529,        346]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:0420\:0430\:0441\:043a\:0440\:0430\:0441\:043a\:0430", " ", 
    "\:0433\:0440\:0430\:0444\:0430"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "E", "]"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"E", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "9", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "10", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "12", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "14", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "15", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "16", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "6", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "10", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "5", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "6", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "15", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "16", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "22", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "10", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "20", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "23", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "14", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "16", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "22", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "23", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "24", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "27", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "16", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "20", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "22", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "26", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "18", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "25", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "27", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "28", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "29", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "31", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "38", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "29", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "26", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "33", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "25", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "33", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "28", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "32", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25", ",", "30", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"25", ",", "36", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "31", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "32", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "36", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "39", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "37", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "35", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "40", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "35", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "40", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "37", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "39", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "41", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "33", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "45", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "36", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "39", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "45", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "41", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "45", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "38", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "45", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "39", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "45", ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "41", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "45", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "45", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "45", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Edge", " ", "lists"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"edgeList", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"x", ",", 
        RowBox[{"UndirectedEdge", "[", 
         RowBox[{
          RowBox[{"Part", "[", 
           RowBox[{"x", ",", "1"}], "]"}], ",", 
          RowBox[{"Part", "[", 
           RowBox[{"x", ",", "2"}], "]"}]}], "]"}]}], "]"}], ",", "E"}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"weights", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"Function", "[", 
        RowBox[{"x", ",", 
         RowBox[{"Part", "[", 
          RowBox[{"x", ",", "3"}], "]"}]}], "]"}], ",", "E"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graph", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{"edgeList", ",", 
       RowBox[{"EdgeWeight", "->", "weights"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graph", "=", 
     RowBox[{"SetProperty", "[", 
      RowBox[{"graph", ",", 
       RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"graph", "=", 
     RowBox[{"SetProperty", "[", 
      RowBox[{"graph", ",", 
       RowBox[{"GraphLayout", "->", 
        RowBox[{"{", 
         RowBox[{"VertexLayout", "->", 
          RowBox[{"{", 
           RowBox[{"\"\<SpringElectricalEmbedding\>\"", ",", 
            RowBox[{"\"\<EdgeWeighted\>\"", "\[Rule]", "True"}]}], "}"}]}], 
         "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"graph", ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"restVertices", "=", 
     RowBox[{"VertexList", "[", "graph", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spanningVertices", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spanningEdges", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FindNext", "[", 
      RowBox[{
      "spanningEdges_", ",", "restEdges_", ",", "spanningVertices_", ",", 
       "restVertices_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "locSpanningEdges", ",", "locRestEdges", ",", "locSpanningVertices", 
         ",", "locRestVertices", ",", "i", ",", "j", ",", "k"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locSpanningEdges", "=", "spanningEdges"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locRestEdges", "=", "restEdges"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locSpanningVertices", "=", "spanningVertices"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locRestVertices", "=", 
         RowBox[{
         "restVertices", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"find", " ", "shortes", " ", "edge"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{"Length", "[", "locRestEdges", "]"}]}], ",", 
            RowBox[{"i", ">", "0"}], ",", 
            RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{"Length", "[", "locRestVertices", "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{"k", "=", "1"}], ",", 
                  RowBox[{"k", "\[LessEqual]", 
                   RowBox[{"Length", "[", "locSpanningVertices", "]"}]}], ",", 
                  RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"If", "[", 
                    RowBox[{"OK", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"locSpanningEdges", ",", 
                    RowBox[{
                    "locRestEdges", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"locSpanningVertices", ",", 
                    RowBox[{
                    "locRestVertices", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}]}], "]"}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"locRestEdges", ",", "i"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Delete", "[", 
                    RowBox[{"locRestVertices", ",", "j"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Length", "[", "locRestVertices", "]"}], ">", 
                    "0"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"outSpanningEdges", " ", "=", 
                    RowBox[{"FindNext", "[", 
                    RowBox[{
                    "locSpanningEdges", ",", "locSpanningVertices", ",", 
                    "restEdges", ",", "restVertices"}], "]"}]}], ";"}]}], 
                    "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Return", "[", "outSpanningEdges", "]"}], ";"}]}],
                     "\[IndentingNewLine]", "]"}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]",
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"highlightedGraph", "=", 
     RowBox[{"HighlightGraph", "[", 
      RowBox[{"graph", ",", "1"}], "]"}]}], ";"}]}]}]], "Input"]
},
WindowSize->{1226, 905},
WindowMargins->{{290, Automatic}, {Automatic, 57}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (September 9, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 12662, 312, 1172, "Input"]
}
]
*)

(* End of internal cache information *)
